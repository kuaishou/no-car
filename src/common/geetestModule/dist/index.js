!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.geetestModule=t()}(this,function(){"use strict";var e;!function(c){if(void 0===c)throw Error("Geetest requires browser environment");var l=c.document,a=c.Math,f=l.getElementsByTagName("head")[0];function i(e){this._obj=e}function t(e){var n=this;new i(e)._each(function(e,t){n[e]=t})}i.prototype={_each:function(e){var t=this._obj;for(var n in t)t.hasOwnProperty(n)&&e(n,t[n]);return this}},t.prototype={api_server:"api.geetest.com",protocol:"http://",typePath:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var e=this;return s(e.type)?e.fallback_config[e.type]:e.new_captcha?e.fallback_config.fullpage:e.fallback_config.slide},_extend:function(e){var n=this;new i(e)._each(function(e,t){n[e]=t})}};var s=function(e){return"string"==typeof e},u=function(e){return"object"==typeof e&&null!==e},g=/Mobi/i.test(navigator.userAgent)?3:0,p={},d={},h=function(e,t,n,o){t=t.replace(/^https?:\/\/|\/$/g,"");var r,a=(0!=(r=(r=n).replace(/\/+/g,"/")).indexOf("/")&&(r="/"+r),r+function(e){if(!e)return"";var n="?";return new i(e)._each(function(e,t){(s(t)||"number"==typeof t||"boolean"==typeof t)&&(n=n+encodeURIComponent(e)+"="+encodeURIComponent(t)+"&")}),"?"===n&&(n=""),n.replace(/&$/,"")}(o));return t&&(a=e+t+a),a},_=function(n,o,r,a,i,e,c){var s=function(t){!function(e,t){var n=l.createElement("script");n.charset="UTF-8",n.async=!0,/static\.geetest\.com/g.test(e)&&(n.crossOrigin="anonymous");var o=(n.onerror=function(){t(!0)},!1);n.onload=n.onreadystatechange=function(){o||n.readyState&&"loaded"!==n.readyState&&"complete"!==n.readyState||(o=!0,setTimeout(function(){t(!1)},0))},n.src=e,f.appendChild(n)}(h(r,a[t],i,e),function(e){e?t<a.length-1?s(t+1):(c(!0),o&&(n.error_code=508,v(n,r+a[t]+i))):c(!1)})};s(0)},n=function(e,t,n,o){if(u(n.getLib))return n._extend(n.getLib),void o(n);if(n.offline)o(n._get_fallback_config());else{var r="geetest_"+(parseInt(1e4*a.random())+(new Date).valueOf());c[r]=function(e){o("success"==e.status?e.data:e.status?n._get_fallback_config():e),c[r]=void 0;try{delete c[r]}catch(e){}},_(n,!0,n.protocol,e,t,{gt:n.gt,callback:r},function(e){e&&o(n._get_fallback_config())})}},v=function(e,t){var n,o,r,a,i,c,s;_(e,!1,e.protocol,["monitor.geetest.com"],"/monitor/send",{time:(n=new Date,o=n.getFullYear(),r=1+n.getMonth(),a=n.getDate(),i=n.getHours(),c=n.getMinutes(),s=n.getSeconds(),r<1||9<r||(r="0"+r),a<0||9<a||(a="0"+a),i<0||9<i||(i="0"+i),c<0||9<c||(c="0"+c),s<0||9<s||(s="0"+s),o+"-"+r+"-"+a+" "+i+":"+c+":"+s),captcha_id:e.gt,challenge:e.challenge,pt:g,exception_url:t,error_code:e.error_code},function(e){})},y=function(e,t){var n={networkError:"网络错误",gtTypeError:"gt字段不是字符串类型"};if("function"!=typeof t.onError)throw Error(n[e]);t.onError(n[e])};(c.Geetest||l.getElementById("gt_lib"))&&(d.slide="loaded"),e=function(e,o){var i=new t(e);e.https?i.protocol="https://":e.protocol||(i.protocol=c.location.protocol+"//"),"050cffef4ae57b5d5e529fea9540b0d1"!==e.gt&&"3bd38408ae4af923ed36e13819b14d42"!==e.gt||(i.apiserver="yumchina.geetest.com/",i.api_server="yumchina.geetest.com"),e.gt&&(c.GeeGT=e.gt),e.challenge&&(c.GeeChallenge=e.challenge),u(e.getType)&&i._extend(e.getType),n([i.api_server||i.apiserver],i.typePath,i,function(e){var a=e.type,t=function(){i._extend(e),o(new c.Geetest(i))};p[a]=p[a]||[];var n=d[a]||"init";"init"===n?(d[a]="loading",p[a].push(t),_(i,!0,i.protocol,e.static_servers||e.domains,e[a]||e.path,null,function(e){if(e)d[a]="fail",y("networkError",i);else{d[a]="loaded";for(var t=p[a],n=0,o=t.length;n<o;n+=1){var r=t[n];"function"==typeof r&&r()}p[a]=[]}})):"loaded"===n?t():"fail"===n?y("networkError",i):"loading"===n&&p[a].push(t)})}}(window);var t=e;window.initGeetest=e;var n=Object.freeze({initGeetest:t});return console.log(n),n});
